{
  "version": 3,
  "sources": ["../../scripts/ts/quick-share-dropzone.ts"],
  "sourcesContent": ["(() => {\n  const dropzone = document.querySelector<HTMLElement>('[data-quick-share-dropzone]');\n  const fileInput = document.querySelector<HTMLInputElement>('[data-quick-share-input]');\n  const pickButton = document.querySelector<HTMLElement>('[data-quick-share-pick]');\n  const status = document.querySelector<HTMLElement>('[data-quick-share-status]');\n  const draftIdInput = document.querySelector<HTMLInputElement>('[data-quick-share-draft-id]');\n  if (!dropzone || !fileInput || !pickButton || !status || !draftIdInput?.value) return;\n\n  const draftShareId = draftIdInput.value;\n\n  const setStatus = (text: string, isError: boolean): void => {\n    status.textContent = text;\n    status.classList.remove('text-ink-muted', 'text-danger');\n    status.classList.add(isError ? 'text-danger' : 'text-ink-muted');\n  };\n\n  const uploadSingleFile = async (file: File): Promise<void> => {\n    const formData = new FormData();\n    formData.append('draftShareId', draftShareId);\n    formData.append('file', file, file.name);\n\n    const response = await fetch('/api/uploads/stage', { method: 'POST', body: formData });\n    if (response.ok) return;\n\n    let error = 'Upload failed.';\n    try {\n      const json = (await response.json()) as { error?: string };\n      if (json?.error) error = json.error;\n    } catch {\n      // ignore non-json responses\n    }\n    throw new Error(error);\n  };\n\n  const queueAndUpload = async (files: FileList | File[] | null | undefined): Promise<void> => {\n    const list = Array.from(files || []);\n    if (!list.length) return;\n\n    setStatus(`Uploading ${list.length} file(s)...`, false);\n    try {\n      for (const file of list) {\n        await uploadSingleFile(file);\n      }\n      setStatus('Upload complete. Redirecting to share setup...', false);\n      window.location.href = `/shares/new?draftShareId=${encodeURIComponent(draftShareId)}`;\n    } catch (error) {\n      setStatus(error instanceof Error ? error.message : 'Upload failed.', true);\n    }\n  };\n\n  pickButton.addEventListener('click', (event) => {\n    event.stopPropagation();\n    fileInput.click();\n  });\n  dropzone.addEventListener('click', () => fileInput.click());\n  dropzone.addEventListener('keydown', (event) => {\n    if (event.key !== 'Enter' && event.key !== ' ') return;\n    event.preventDefault();\n    fileInput.click();\n  });\n\n  fileInput.addEventListener('change', () => {\n    queueAndUpload(fileInput.files);\n    fileInput.value = '';\n  });\n\n  dropzone.addEventListener('dragover', (event) => {\n    event.preventDefault();\n    dropzone.classList.add('ring-2', 'ring-terra/40');\n  });\n  dropzone.addEventListener('dragleave', () => dropzone.classList.remove('ring-2', 'ring-terra/40'));\n  dropzone.addEventListener('drop', (event) => {\n    event.preventDefault();\n    dropzone.classList.remove('ring-2', 'ring-terra/40');\n    queueAndUpload(event.dataTransfer?.files || []);\n  });\n})();\n"],
  "mappings": ";;;AAAA,GAAC,MAAM;AACL,UAAM,WAAW,SAAS,cAA2B,6BAA6B;AAClF,UAAM,YAAY,SAAS,cAAgC,0BAA0B;AACrF,UAAM,aAAa,SAAS,cAA2B,yBAAyB;AAChF,UAAM,SAAS,SAAS,cAA2B,2BAA2B;AAC9E,UAAM,eAAe,SAAS,cAAgC,6BAA6B;AAC3F,QAAI,CAAC,YAAY,CAAC,aAAa,CAAC,cAAc,CAAC,UAAU,CAAC,cAAc,MAAO;AAE/E,UAAM,eAAe,aAAa;AAElC,UAAM,YAAY,CAAC,MAAc,YAA2B;AAC1D,aAAO,cAAc;AACrB,aAAO,UAAU,OAAO,kBAAkB,aAAa;AACvD,aAAO,UAAU,IAAI,UAAU,gBAAgB,gBAAgB;AAAA,IACjE;AAEA,UAAM,mBAAmB,OAAO,SAA8B;AAC5D,YAAM,WAAW,IAAI,SAAS;AAC9B,eAAS,OAAO,gBAAgB,YAAY;AAC5C,eAAS,OAAO,QAAQ,MAAM,KAAK,IAAI;AAEvC,YAAM,WAAW,MAAM,MAAM,sBAAsB,EAAE,QAAQ,QAAQ,MAAM,SAAS,CAAC;AACrF,UAAI,SAAS,GAAI;AAEjB,UAAI,QAAQ;AACZ,UAAI;AACF,cAAM,OAAQ,MAAM,SAAS,KAAK;AAClC,YAAI,MAAM,MAAO,SAAQ,KAAK;AAAA,MAChC,QAAQ;AAAA,MAER;AACA,YAAM,IAAI,MAAM,KAAK;AAAA,IACvB;AAEA,UAAM,iBAAiB,OAAO,UAA+D;AAC3F,YAAM,OAAO,MAAM,KAAK,SAAS,CAAC,CAAC;AACnC,UAAI,CAAC,KAAK,OAAQ;AAElB,gBAAU,aAAa,KAAK,MAAM,eAAe,KAAK;AACtD,UAAI;AACF,mBAAW,QAAQ,MAAM;AACvB,gBAAM,iBAAiB,IAAI;AAAA,QAC7B;AACA,kBAAU,kDAAkD,KAAK;AACjE,eAAO,SAAS,OAAO,4BAA4B,mBAAmB,YAAY,CAAC;AAAA,MACrF,SAAS,OAAO;AACd,kBAAU,iBAAiB,QAAQ,MAAM,UAAU,kBAAkB,IAAI;AAAA,MAC3E;AAAA,IACF;AAEA,eAAW,iBAAiB,SAAS,CAAC,UAAU;AAC9C,YAAM,gBAAgB;AACtB,gBAAU,MAAM;AAAA,IAClB,CAAC;AACD,aAAS,iBAAiB,SAAS,MAAM,UAAU,MAAM,CAAC;AAC1D,aAAS,iBAAiB,WAAW,CAAC,UAAU;AAC9C,UAAI,MAAM,QAAQ,WAAW,MAAM,QAAQ,IAAK;AAChD,YAAM,eAAe;AACrB,gBAAU,MAAM;AAAA,IAClB,CAAC;AAED,cAAU,iBAAiB,UAAU,MAAM;AACzC,qBAAe,UAAU,KAAK;AAC9B,gBAAU,QAAQ;AAAA,IACpB,CAAC;AAED,aAAS,iBAAiB,YAAY,CAAC,UAAU;AAC/C,YAAM,eAAe;AACrB,eAAS,UAAU,IAAI,UAAU,eAAe;AAAA,IAClD,CAAC;AACD,aAAS,iBAAiB,aAAa,MAAM,SAAS,UAAU,OAAO,UAAU,eAAe,CAAC;AACjG,aAAS,iBAAiB,QAAQ,CAAC,UAAU;AAC3C,YAAM,eAAe;AACrB,eAAS,UAAU,OAAO,UAAU,eAAe;AACnD,qBAAe,MAAM,cAAc,SAAS,CAAC,CAAC;AAAA,IAChD,CAAC;AAAA,EACH,GAAG;",
  "names": []
}
