{
  "version": 3,
  "sources": ["../../scripts/ts/upload-limits.ts", "../../scripts/ts/quick-share-dropzone.ts"],
  "sourcesContent": ["export type UploadLimits = {\n  maxFilesPerShare: number;\n  maxFileSizeBytes: number;\n  maxTotalUploadBytes: number;\n};\n\nexport const formatLimitBytes = (bytes: number): string => {\n  if (!Number.isFinite(bytes) || bytes <= 0) return '';\n  if (bytes >= 1024 * 1024 * 1024) return `${(bytes / (1024 * 1024 * 1024)).toFixed(1)} GB`;\n  if (bytes >= 1024 * 1024) return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\n  if (bytes >= 1024) return `${(bytes / 1024).toFixed(1)} KB`;\n  return `${bytes} B`;\n};\n\nexport type ValidationResult = { ok: true } | { ok: false; message: string };\n\n/**\n * Validate a batch of files against upload limits before any upload starts.\n * `currentFileCount` = already-uploaded + in-flight files.\n * `currentTotalBytes` = sum of already-uploaded file sizes.\n */\nexport const validateFileSelection = (\n  files: File[],\n  limits: UploadLimits,\n  currentFileCount: number,\n  currentTotalBytes: number\n): ValidationResult => {\n  if (files.length === 0) return { ok: true };\n\n  if (limits.maxFilesPerShare > 0 && currentFileCount >= limits.maxFilesPerShare) {\n    return { ok: false, message: `You already have ${currentFileCount} file(s) staged \u2014 the maximum is ${limits.maxFilesPerShare} files per share.` };\n  }\n\n  if (limits.maxFilesPerShare > 0 && currentFileCount + files.length > limits.maxFilesPerShare) {\n    const remaining = limits.maxFilesPerShare - currentFileCount;\n    return {\n      ok: false,\n      message: `You selected ${files.length} file(s) but can only add ${remaining} more (limit: ${limits.maxFilesPerShare} per share).`\n    };\n  }\n\n  let batchBytes = 0;\n  for (const file of files) {\n    if (limits.maxFileSizeBytes > 0 && file.size > limits.maxFileSizeBytes) {\n      return {\n        ok: false,\n        message: `\"${file.name}\" is ${formatLimitBytes(file.size)} which exceeds the per-file limit of ${formatLimitBytes(limits.maxFileSizeBytes)}.`\n      };\n    }\n\n    batchBytes += file.size;\n    if (limits.maxTotalUploadBytes > 0 && currentTotalBytes + batchBytes > limits.maxTotalUploadBytes) {\n      return {\n        ok: false,\n        message: `Adding these files would exceed the total upload limit of ${formatLimitBytes(limits.maxTotalUploadBytes)}.`\n      };\n    }\n  }\n\n  return { ok: true };\n};\n\nlet limitDialog: HTMLDialogElement | null = null;\nlet limitDialogMessage: HTMLParagraphElement | null = null;\n\nconst ensureDialog = (): { dialog: HTMLDialogElement; messageNode: HTMLParagraphElement } => {\n  if (limitDialog && limitDialogMessage) return { dialog: limitDialog, messageNode: limitDialogMessage };\n\n  const dialog = document.createElement('dialog');\n  dialog.className = 'rounded-xl border border-border bg-white p-0 w-full max-w-sm m-auto';\n  dialog.style.cssText = 'margin: auto;';\n  dialog.setAttribute('style', 'margin: auto; --tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1); box-shadow: var(--tw-shadow);');\n\n  const inner = document.createElement('div');\n  inner.className = 'p-5';\n\n  const heading = document.createElement('h3');\n  heading.className = 'font-display text-2xl tracking-tight';\n  heading.textContent = 'Upload limit reached';\n\n  const message = document.createElement('p');\n  message.className = 'text-sm text-ink-muted mt-2';\n\n  const footer = document.createElement('div');\n  footer.className = 'mt-5 flex justify-end';\n\n  const okButton = document.createElement('button');\n  okButton.type = 'button';\n  okButton.className = 'px-4 py-2 text-sm bg-terra text-white rounded-lg hover:bg-terra/90 transition-colors';\n  okButton.textContent = 'OK';\n  okButton.addEventListener('click', () => dialog.close());\n\n  footer.appendChild(okButton);\n  inner.append(heading, message, footer);\n  dialog.appendChild(inner);\n\n  // Also close on backdrop click\n  dialog.addEventListener('click', (event) => {\n    if (event.target === dialog) dialog.close();\n  });\n\n  document.body.appendChild(dialog);\n  limitDialog = dialog;\n  limitDialogMessage = message;\n\n  return { dialog, messageNode: message };\n};\n\n/** Show a modal dialog with the validation error message. */\nexport const showLimitDialog = (message: string): void => {\n  const { dialog, messageNode } = ensureDialog();\n  messageNode.textContent = message;\n  dialog.showModal();\n};\n\n/** Read limits from a container element's data attributes. */\nexport const readLimitsFromElement = (el: HTMLElement): UploadLimits => ({\n  maxFilesPerShare: Number(el.dataset.maxFilesPerShare || '0'),\n  maxFileSizeBytes: Number(el.dataset.maxFileSizeBytes || '0'),\n  maxTotalUploadBytes: Number(el.dataset.maxTotalUploadBytes || '0')\n});\n", "import { readLimitsFromElement, validateFileSelection, showLimitDialog } from './upload-limits';\n\n(() => {\n  const dropzone = document.querySelector<HTMLElement>('[data-quick-share-dropzone]');\n  const fileInput = document.querySelector<HTMLInputElement>('[data-quick-share-input]');\n  const pickButton = document.querySelector<HTMLButtonElement>('[data-quick-share-pick]');\n  const cancelButton = document.querySelector<HTMLButtonElement>('[data-quick-share-cancel]');\n  const status = document.querySelector<HTMLElement>('[data-quick-share-status]');\n  const uploadList = document.querySelector<HTMLUListElement>('[data-quick-share-upload-list]');\n  const draftIdInput = document.querySelector<HTMLInputElement>('[data-quick-share-draft-id]');\n  if (!dropzone || !fileInput || !pickButton || !cancelButton || !status || !uploadList || !draftIdInput?.value) return;\n\n  const limits = readLimitsFromElement(dropzone);\n\n  const draftShareId = draftIdInput.value;\n  let activeXhr: XMLHttpRequest | null = null;\n  let isUploading = false;\n  let cancelRequested = false;\n\n  type UploadUi = {\n    row: HTMLLIElement;\n    size: HTMLParagraphElement;\n    barWrap: HTMLDivElement;\n    bar: HTMLDivElement;\n    state: HTMLParagraphElement;\n  };\n\n  const setStatus = (text: string, isError: boolean): void => {\n    status.textContent = text;\n    status.classList.remove('text-ink-muted', 'text-danger');\n    status.classList.add(isError ? 'text-danger' : 'text-ink-muted');\n  };\n\n  const formatBytes = (bytes: number): string => {\n    if (!Number.isFinite(bytes) || bytes < 0) return '0 B';\n    if (bytes >= 1024 * 1024 * 1024) return `${(bytes / (1024 * 1024 * 1024)).toFixed(2)} GB`;\n    if (bytes >= 1024 * 1024) return `${(bytes / (1024 * 1024)).toFixed(2)} MB`;\n    if (bytes >= 1024) return `${(bytes / 1024).toFixed(2)} KB`;\n    return `${bytes} B`;\n  };\n\n  const setControls = (uploading: boolean): void => {\n    isUploading = uploading;\n    fileInput.disabled = uploading;\n    pickButton.disabled = uploading;\n    pickButton.title = uploading ? 'Upload in progress.' : '';\n    cancelButton.classList.toggle('hidden', !uploading);\n    cancelButton.disabled = !uploading;\n    cancelButton.title = uploading ? 'Cancel upload and queue immediate cleanup.' : 'No upload is currently running.';\n  };\n\n  const createUploadRow = (file: File): UploadUi => {\n    const row = document.createElement('li');\n    row.className = 'rounded-lg border border-border bg-white px-2.5 py-2 min-w-0';\n\n    const name = document.createElement('p');\n    name.className = 'text-xs text-ink-light truncate';\n    name.textContent = file.name;\n\n    const size = document.createElement('p');\n    size.className = 'text-[11px] text-ink-muted mt-0.5';\n    size.textContent = formatBytes(file.size);\n\n    const barWrap = document.createElement('div');\n    barWrap.className = 'mt-1.5 h-1 bg-cream-dark rounded-full overflow-hidden';\n\n    const bar = document.createElement('div');\n    bar.className = 'h-full bg-terra transition-all';\n    bar.style.width = '0%';\n    barWrap.appendChild(bar);\n\n    const state = document.createElement('p');\n    state.className = 'text-[11px] text-ink-muted mt-1';\n    state.textContent = 'Pending';\n\n    row.append(name, size, barWrap, state);\n    uploadList.appendChild(row);\n    return { row, size, barWrap, bar, state };\n  };\n\n  const markCanceledCard = (ui: UploadUi): void => {\n    ui.row.className = 'rounded-lg border border-border bg-cream px-2.5 py-2 min-w-0';\n    ui.barWrap.style.display = 'none';\n    ui.state.textContent = 'Canceled';\n    ui.state.className = 'text-[11px] text-ink-muted mt-1';\n  };\n\n  const uploadSingleFile = (file: File, ui: UploadUi): Promise<string> => {\n    return new Promise<string>((resolve, reject) => {\n      const xhr = new XMLHttpRequest();\n      activeXhr = xhr;\n      xhr.open('POST', '/api/uploads/stage');\n      xhr.responseType = 'json';\n\n      xhr.upload.addEventListener('progress', (event) => {\n        if (!event.lengthComputable) return;\n        const percent = Math.min(100, Math.round((event.loaded / event.total) * 100));\n        ui.bar.style.width = `${percent}%`;\n        ui.state.textContent = `Uploading ${formatBytes(event.loaded)} / ${formatBytes(event.total)} (${percent}%)`;\n      });\n\n      xhr.addEventListener('load', () => {\n        activeXhr = null;\n        if (xhr.status >= 200 && xhr.status < 300) {\n          const payload = xhr.response as { uploadId?: string } | null;\n          if (!payload?.uploadId) {\n            reject(new Error('Upload failed.'));\n            return;\n          }\n\n          ui.row.className = 'rounded-lg border border-sage/35 bg-sage-wash px-2.5 py-2 min-w-0';\n          ui.size.style.display = 'none';\n          ui.barWrap.style.display = 'none';\n          ui.state.textContent = formatBytes(file.size);\n          ui.state.className = 'text-[11px] text-sage mt-1';\n          resolve(payload.uploadId);\n          return;\n        }\n\n        const payload = xhr.response as { error?: string } | null;\n        reject(new Error(payload?.error?.trim() || 'Upload failed.'));\n      });\n\n      xhr.addEventListener('abort', () => {\n        activeXhr = null;\n        reject(new Error('Upload canceled.'));\n      });\n\n      xhr.addEventListener('error', () => {\n        activeXhr = null;\n        reject(new Error('Upload failed.'));\n      });\n\n      const formData = new FormData();\n      formData.append('draftShareId', draftShareId);\n      formData.append('file', file, file.name);\n      xhr.send(formData);\n    });\n  };\n\n  const queueCleanupJob = async (): Promise<void> => {\n    const formData = new FormData();\n    formData.append('draftShareId', draftShareId);\n\n    try {\n      await fetch('/api/uploads/cancel', { method: 'POST', body: formData, credentials: 'same-origin' });\n      setStatus('Upload canceled. Cleanup queued in background.', false);\n    } catch {\n      setStatus('Upload canceled. Cleanup request failed; please retry.', true);\n    }\n  };\n\n  const queueAndUpload = async (files: FileList | File[] | null | undefined): Promise<void> => {\n    if (isUploading) return;\n\n    const selected = Array.from(files ?? []);\n    if (selected.length === 0) return;\n\n    const result = validateFileSelection(selected, limits, 0, 0);\n    if (!result.ok) {\n      showLimitDialog(result.message);\n      return;\n    }\n\n    uploadList.innerHTML = '';\n    cancelRequested = false;\n    setControls(true);\n    const cards = selected.map((file) => ({ file, ui: createUploadRow(file) }));\n\n    setStatus(`Uploading ${cards.length} file(s)...`, false);\n    try {\n      for (const card of cards) {\n        if (cancelRequested) {\n          markCanceledCard(card.ui);\n          continue;\n        }\n\n        await uploadSingleFile(card.file, card.ui);\n      }\n\n      if (cancelRequested) {\n        cards.forEach((card) => {\n          if (card.ui.state.className.includes('text-sage')) {\n            card.ui.state.textContent = 'Canceled (cleanup queued)';\n            card.ui.state.className = 'text-[11px] text-ink-muted mt-1';\n            card.ui.row.className = 'rounded-lg border border-border bg-cream px-2.5 py-2 min-w-0';\n          } else if (!card.ui.state.className.includes('text-danger')) {\n            markCanceledCard(card.ui);\n          }\n        });\n        await queueCleanupJob();\n        return;\n      }\n\n      setStatus('Upload complete. Redirecting to share setup...', false);\n      window.location.href = `/shares/new?draftShareId=${encodeURIComponent(draftShareId)}`;\n    } catch (error) {\n      if (cancelRequested) {\n        await queueCleanupJob();\n        return;\n      }\n\n      setStatus(error instanceof Error ? error.message : 'Upload failed.', true);\n    } finally {\n      setControls(false);\n      activeXhr = null;\n    }\n  };\n\n  cancelButton.addEventListener('click', () => {\n    if (!isUploading || cancelRequested) return;\n    cancelRequested = true;\n    cancelButton.disabled = true;\n    cancelButton.title = 'Canceling upload...';\n    setStatus('Canceling upload...', false);\n    activeXhr?.abort();\n  });\n\n  pickButton.addEventListener('click', (event) => {\n    event.stopPropagation();\n    if (isUploading) return;\n    fileInput.click();\n  });\n  dropzone.addEventListener('click', () => {\n    if (isUploading) return;\n    fileInput.click();\n  });\n  dropzone.addEventListener('keydown', (event) => {\n    if (event.key !== 'Enter' && event.key !== ' ') return;\n    event.preventDefault();\n    if (isUploading) return;\n    fileInput.click();\n  });\n\n  fileInput.addEventListener('change', () => {\n    queueAndUpload(fileInput.files);\n    fileInput.value = '';\n  });\n\n  dropzone.addEventListener('dragover', (event) => {\n    event.preventDefault();\n    dropzone.classList.add('ring-2', 'ring-terra/40');\n  });\n  dropzone.addEventListener('dragleave', () => dropzone.classList.remove('ring-2', 'ring-terra/40'));\n  dropzone.addEventListener('drop', (event) => {\n    event.preventDefault();\n    dropzone.classList.remove('ring-2', 'ring-terra/40');\n    queueAndUpload(event.dataTransfer?.files || []);\n  });\n\n  setControls(false);\n})();\n"],
  "mappings": "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",
  "names": ["payload"]
}
