{
  "version": 3,
  "sources": ["../../scripts/ts/upload-limits.ts", "../../scripts/ts/public-upload.ts"],
  "sourcesContent": ["export type UploadLimits = {\n  maxFilesPerShare: number;\n  maxFileSizeBytes: number;\n  maxTotalUploadBytes: number;\n};\n\nexport const formatLimitBytes = (bytes: number): string => {\n  if (!Number.isFinite(bytes) || bytes <= 0) return '';\n  if (bytes >= 1024 * 1024 * 1024) return `${(bytes / (1024 * 1024 * 1024)).toFixed(1)} GB`;\n  if (bytes >= 1024 * 1024) return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\n  if (bytes >= 1024) return `${(bytes / 1024).toFixed(1)} KB`;\n  return `${bytes} B`;\n};\n\nexport type ValidationResult = { ok: true } | { ok: false; message: string };\n\n/**\n * Validate a batch of files against upload limits before any upload starts.\n * `currentFileCount` = already-uploaded + in-flight files.\n * `currentTotalBytes` = sum of already-uploaded file sizes.\n */\nexport const validateFileSelection = (\n  files: File[],\n  limits: UploadLimits,\n  currentFileCount: number,\n  currentTotalBytes: number\n): ValidationResult => {\n  if (files.length === 0) return { ok: true };\n\n  if (limits.maxFilesPerShare > 0 && currentFileCount >= limits.maxFilesPerShare) {\n    return { ok: false, message: `You already have ${currentFileCount} file(s) staged \u2014 the maximum is ${limits.maxFilesPerShare} files per share.` };\n  }\n\n  if (limits.maxFilesPerShare > 0 && currentFileCount + files.length > limits.maxFilesPerShare) {\n    const remaining = limits.maxFilesPerShare - currentFileCount;\n    return {\n      ok: false,\n      message: `You selected ${files.length} file(s) but can only add ${remaining} more (limit: ${limits.maxFilesPerShare} per share).`\n    };\n  }\n\n  let batchBytes = 0;\n  for (const file of files) {\n    if (limits.maxFileSizeBytes > 0 && file.size > limits.maxFileSizeBytes) {\n      return {\n        ok: false,\n        message: `\"${file.name}\" is ${formatLimitBytes(file.size)} which exceeds the per-file limit of ${formatLimitBytes(limits.maxFileSizeBytes)}.`\n      };\n    }\n\n    batchBytes += file.size;\n    if (limits.maxTotalUploadBytes > 0 && currentTotalBytes + batchBytes > limits.maxTotalUploadBytes) {\n      return {\n        ok: false,\n        message: `Adding these files would exceed the total upload limit of ${formatLimitBytes(limits.maxTotalUploadBytes)}.`\n      };\n    }\n  }\n\n  return { ok: true };\n};\n\nlet limitDialog: HTMLDialogElement | null = null;\nlet limitDialogMessage: HTMLParagraphElement | null = null;\n\nconst ensureDialog = (): { dialog: HTMLDialogElement; messageNode: HTMLParagraphElement } => {\n  if (limitDialog && limitDialogMessage) return { dialog: limitDialog, messageNode: limitDialogMessage };\n\n  const dialog = document.createElement('dialog');\n  dialog.className = 'rounded-xl border border-border bg-white p-0 w-full max-w-sm m-auto';\n  dialog.style.cssText = 'margin: auto;';\n  dialog.setAttribute('style', 'margin: auto; --tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1); box-shadow: var(--tw-shadow);');\n\n  const inner = document.createElement('div');\n  inner.className = 'p-5';\n\n  const heading = document.createElement('h3');\n  heading.className = 'font-display text-2xl tracking-tight';\n  heading.textContent = 'Upload limit reached';\n\n  const message = document.createElement('p');\n  message.className = 'text-sm text-ink-muted mt-2';\n\n  const footer = document.createElement('div');\n  footer.className = 'mt-5 flex justify-end';\n\n  const okButton = document.createElement('button');\n  okButton.type = 'button';\n  okButton.className = 'px-4 py-2 text-sm bg-terra text-white rounded-lg hover:bg-terra/90 transition-colors';\n  okButton.textContent = 'OK';\n  okButton.addEventListener('click', () => dialog.close());\n\n  footer.appendChild(okButton);\n  inner.append(heading, message, footer);\n  dialog.appendChild(inner);\n\n  // Also close on backdrop click\n  dialog.addEventListener('click', (event) => {\n    if (event.target === dialog) dialog.close();\n  });\n\n  document.body.appendChild(dialog);\n  limitDialog = dialog;\n  limitDialogMessage = message;\n\n  return { dialog, messageNode: message };\n};\n\n/** Show a modal dialog with the validation error message. */\nexport const showLimitDialog = (message: string): void => {\n  const { dialog, messageNode } = ensureDialog();\n  messageNode.textContent = message;\n  dialog.showModal();\n};\n\n/** Read limits from a container element's data attributes. */\nexport const readLimitsFromElement = (el: HTMLElement): UploadLimits => ({\n  maxFilesPerShare: Number(el.dataset.maxFilesPerShare || '0'),\n  maxFileSizeBytes: Number(el.dataset.maxFileSizeBytes || '0'),\n  maxTotalUploadBytes: Number(el.dataset.maxTotalUploadBytes || '0')\n});\n", "import { readLimitsFromElement, validateFileSelection, showLimitDialog } from './upload-limits';\n\n(() => {\n  const successScreen = document.querySelector<HTMLElement>('[data-public-upload-success]');\n  if (successScreen) {\n    runConfetti();\n  }\n\n  const form = document.querySelector<HTMLFormElement>('[data-public-upload-form]');\n  if (!form) return;\n\n  const fileInput = form.querySelector<HTMLInputElement>('[data-public-file-input]');\n  const pickButton = form.querySelector<HTMLButtonElement>('[data-public-pick-files]');\n  const dropzone = form.querySelector<HTMLElement>('[data-public-dropzone]');\n  const status = form.querySelector<HTMLElement>('[data-public-upload-status]');\n  const uploadList = form.querySelector<HTMLUListElement>('[data-public-upload-list]');\n  const hidden = form.querySelector<HTMLElement>('[data-public-upload-hidden]');\n  const submit = form.querySelector<HTMLButtonElement>('[data-public-submit]');\n  const senderNameInput = form.querySelector<HTMLInputElement>('input[name=\"senderName\"]');\n  const senderEmailInput = form.querySelector<HTMLInputElement>('input[name=\"senderEmail\"]');\n  const senderMessageInput = form.querySelector<HTMLTextAreaElement>('textarea[name=\"senderMessage\"]');\n  const uploadToken = form.querySelector<HTMLInputElement>('[data-public-upload-token]')?.value ?? '';\n  const draftShareId = form.querySelector<HTMLInputElement>('[data-public-draft-share-id]')?.value ?? '';\n\n  if (!fileInput || !pickButton || !dropzone || !status || !uploadList || !hidden || !submit || !uploadToken || !draftShareId) {\n    return;\n  }\n\n  const limits = readLimitsFromElement(form);\n  const senderNameStorageKey = 'agora:public-upload:sender-name';\n  const senderEmailStorageKey = 'agora:public-upload:sender-email';\n  const uploadedIds = new Set<string>();\n  const uploadedSizes = new Map<string, number>();\n  let activeUploads = 0;\n  const pickPrimaryClass = 'px-4 py-2 bg-terra text-white text-sm font-medium rounded-lg hover:bg-terra/90 transition-colors';\n  const pickSecondaryClass = 'px-4 py-2 bg-cream text-ink text-sm font-medium rounded-lg border border-border hover:bg-cream-dark/70 transition-colors';\n\n  const formatBytes = (bytes: number): string => {\n    if (!Number.isFinite(bytes) || bytes < 0) return '0 B';\n    if (bytes >= 1024 * 1024 * 1024) return `${(bytes / (1024 * 1024 * 1024)).toFixed(2)} GB`;\n    if (bytes >= 1024 * 1024) return `${(bytes / (1024 * 1024)).toFixed(2)} MB`;\n    if (bytes >= 1024) return `${(bytes / 1024).toFixed(2)} KB`;\n    return `${bytes} B`;\n  };\n\n  const refreshState = (): void => {\n    const hasUploadedFiles = uploadedIds.size > 0;\n    const senderEmail = (senderEmailInput?.value || '').trim();\n    pickButton.className = hasUploadedFiles ? pickSecondaryClass : pickPrimaryClass;\n    pickButton.textContent = hasUploadedFiles ? 'Add more files' : 'Select files';\n    submit.classList.toggle('hidden', !hasUploadedFiles);\n\n    let reason = '';\n    if (activeUploads > 0) {\n      reason = 'Please wait for uploads to finish.';\n    } else if (uploadedIds.size === 0) {\n      reason = 'Upload at least one file first.';\n    } else if (!senderEmail) {\n      reason = 'Enter your email first.';\n    }\n\n    submit.disabled = reason.length > 0;\n    submit.title = reason;\n\n    if (activeUploads > 0) {\n      status.textContent = `Uploading ${activeUploads} file(s)...`;\n      return;\n    }\n\n    status.textContent = uploadedIds.size > 0\n      ? `${uploadedIds.size} file(s) uploaded and ready.`\n      : 'No files uploaded yet.';\n  };\n\n  const restoreSenderFields = (): void => {\n    if (!senderNameInput && !senderEmailInput) return;\n    try {\n      if (senderNameInput && !senderNameInput.value) {\n        senderNameInput.value = (localStorage.getItem(senderNameStorageKey) || '').trim();\n      }\n      if (senderEmailInput && !senderEmailInput.value) {\n        senderEmailInput.value = (localStorage.getItem(senderEmailStorageKey) || '').trim();\n      }\n    } catch {\n      // Ignore localStorage access errors.\n    }\n  };\n\n  const persistSenderFields = (): void => {\n    if (!senderNameInput && !senderEmailInput) return;\n    try {\n      if (senderNameInput) {\n        localStorage.setItem(senderNameStorageKey, senderNameInput.value.trim());\n      }\n      if (senderEmailInput) {\n        localStorage.setItem(senderEmailStorageKey, senderEmailInput.value.trim());\n      }\n    } catch {\n      // Ignore localStorage access errors.\n    }\n  };\n\n  const autoSizeSenderMessage = (): void => {\n    if (!senderMessageInput) return;\n    senderMessageInput.style.height = 'auto';\n    senderMessageInput.style.height = `${Math.max(senderMessageInput.scrollHeight, 96)}px`;\n  };\n\n  const createRow = (file: File): { row: HTMLLIElement; bar: HTMLDivElement; note: HTMLParagraphElement } => {\n    const row = document.createElement('li');\n    row.className = 'rounded-lg border border-border bg-white px-2.5 py-2 min-w-0';\n\n    const name = document.createElement('p');\n    name.className = 'text-xs text-ink-light truncate';\n    name.textContent = file.name;\n\n    const barWrap = document.createElement('div');\n    barWrap.className = 'mt-1.5 h-1 bg-cream-dark rounded-full overflow-hidden';\n\n    const bar = document.createElement('div');\n    bar.className = 'h-full bg-terra transition-all';\n    bar.style.width = '0%';\n    barWrap.appendChild(bar);\n\n    const note = document.createElement('p');\n    note.className = 'text-[11px] text-ink-muted mt-1';\n    note.textContent = 'Pending';\n\n    row.append(name, barWrap, note);\n    uploadList.appendChild(row);\n    return { row, bar, note };\n  };\n\n  const addHidden = (id: string): void => {\n    const input = document.createElement('input');\n    input.type = 'hidden';\n    input.name = 'uploadedFileIds';\n    input.value = id;\n    input.setAttribute('data-uploaded-file-id', id);\n    hidden.appendChild(input);\n  };\n\n  const uploadSingleFile = (file: File): Promise<void> => {\n    const ui = createRow(file);\n\n    return new Promise<void>((resolve, reject) => {\n      const xhr = new XMLHttpRequest();\n      xhr.open('POST', '/api/public-uploads/stage');\n      xhr.responseType = 'json';\n\n      xhr.upload.addEventListener('progress', (event) => {\n        if (!event.lengthComputable) return;\n        const percent = Math.min(100, Math.round((event.loaded / event.total) * 100));\n        ui.bar.style.width = `${percent}%`;\n        ui.note.textContent = `Uploading ${formatBytes(event.loaded)} / ${formatBytes(event.total)} (${percent}%)`;\n      });\n\n      xhr.addEventListener('load', () => {\n        if (xhr.status >= 200 && xhr.status < 300) {\n          const payload = xhr.response as { uploadId?: string } | null;\n          if (!payload?.uploadId) {\n            reject(new Error('Upload failed.'));\n            return;\n          }\n\n          uploadedIds.add(payload.uploadId);\n          uploadedSizes.set(payload.uploadId, file.size);\n          addHidden(payload.uploadId);\n          ui.row.className = 'rounded-lg border border-sage/35 bg-sage-wash px-2.5 py-2 min-w-0';\n          ui.note.className = 'text-[11px] text-sage mt-1';\n          ui.note.textContent = `Uploaded \u00B7 ${formatBytes(file.size)}`;\n          resolve();\n          return;\n        }\n\n        const payload = xhr.response as { error?: string } | null;\n        reject(new Error(payload?.error?.trim() || 'Upload failed.'));\n      });\n\n      xhr.addEventListener('error', () => reject(new Error('Upload failed.')));\n\n      const formData = new FormData();\n      formData.append('uploadToken', uploadToken);\n      formData.append('draftShareId', draftShareId);\n      formData.append('file', file, file.name);\n      xhr.send(formData);\n    });\n  };\n\n  const queueUploads = async (files: FileList | File[] | null | undefined): Promise<void> => {\n    const selected = Array.from(files ?? []);\n    if (selected.length === 0 || activeUploads > 0) {\n      return;\n    }\n\n    const currentTotalBytes = Array.from(uploadedSizes.values()).reduce((sum, size) => sum + size, 0);\n    const result = validateFileSelection(selected, limits, uploadedIds.size, currentTotalBytes);\n    if (!result.ok) {\n      showLimitDialog(result.message);\n      return;\n    }\n\n    for (const file of selected) {\n      activeUploads += 1;\n      refreshState();\n      try {\n        await uploadSingleFile(file);\n      } catch (error) {\n        status.textContent = error instanceof Error ? error.message : 'Upload failed.';\n      } finally {\n        activeUploads -= 1;\n        refreshState();\n      }\n    }\n  };\n\n  pickButton.addEventListener('click', () => {\n    if (activeUploads > 0) return;\n    fileInput.click();\n  });\n\n  dropzone.addEventListener('click', () => {\n    if (activeUploads > 0) return;\n    fileInput.click();\n  });\n\n  fileInput.addEventListener('change', () => {\n    void queueUploads(fileInput.files);\n    fileInput.value = '';\n  });\n\n  dropzone.addEventListener('dragover', (event) => {\n    event.preventDefault();\n    dropzone.classList.add('ring-2', 'ring-terra/40');\n  });\n\n  dropzone.addEventListener('dragleave', () => {\n    dropzone.classList.remove('ring-2', 'ring-terra/40');\n  });\n\n  dropzone.addEventListener('drop', (event) => {\n    event.preventDefault();\n    dropzone.classList.remove('ring-2', 'ring-terra/40');\n    void queueUploads(event.dataTransfer?.files || []);\n  });\n\n  restoreSenderFields();\n  senderNameInput?.addEventListener('input', persistSenderFields);\n  senderEmailInput?.addEventListener('input', persistSenderFields);\n  senderEmailInput?.addEventListener('input', refreshState);\n  senderMessageInput?.addEventListener('input', autoSizeSenderMessage);\n  autoSizeSenderMessage();\n\n  refreshState();\n})();\n\nfunction runConfetti(): void {\n  const canvas = document.querySelector<HTMLCanvasElement>('[data-public-upload-confetti-canvas]');\n  if (!canvas) return;\n\n  const context = canvas.getContext('2d');\n  if (!context) return;\n\n  const colors = ['#C4663A', '#E8A17D', '#5B7A5E', '#1A1614', '#F0EBE3'];\n  const pieceCount = 160;\n  const gravity = 0.18;\n  const durationMs = 4200;\n\n  type Piece = {\n    x: number;\n    y: number;\n    vx: number;\n    vy: number;\n    size: number;\n    rotation: number;\n    spin: number;\n    color: string;\n  };\n\n  const pieces: Piece[] = [];\n  let width = 0;\n  let height = 0;\n  let start = 0;\n\n  const resize = (): void => {\n    width = window.innerWidth;\n    height = window.innerHeight;\n    canvas.width = Math.floor(width * window.devicePixelRatio);\n    canvas.height = Math.floor(height * window.devicePixelRatio);\n    context.setTransform(window.devicePixelRatio, 0, 0, window.devicePixelRatio, 0, 0);\n  };\n\n  const resetPiece = (piece: Piece, fromTop: boolean): void => {\n    piece.x = Math.random() * width;\n    piece.y = fromTop ? -20 - Math.random() * height * 0.4 : Math.random() * -height;\n    piece.vx = (Math.random() - 0.5) * 2.6;\n    piece.vy = 2.2 + Math.random() * 2.8;\n    piece.size = 5 + Math.random() * 7;\n    piece.rotation = Math.random() * Math.PI * 2;\n    piece.spin = (Math.random() - 0.5) * 0.25;\n    piece.color = colors[Math.floor(Math.random() * colors.length)];\n  };\n\n  const init = (): void => {\n    pieces.length = 0;\n    for (let i = 0; i < pieceCount; i += 1) {\n      const piece = {} as Piece;\n      resetPiece(piece, false);\n      pieces.push(piece);\n    }\n  };\n\n  const draw = (): void => {\n    context.clearRect(0, 0, width, height);\n    for (const piece of pieces) {\n      piece.x += piece.vx;\n      piece.y += piece.vy;\n      piece.vy += gravity * 0.02;\n      piece.rotation += piece.spin;\n\n      if (piece.y > height + 24 || piece.x < -24 || piece.x > width + 24) {\n        resetPiece(piece, true);\n      }\n\n      context.save();\n      context.translate(piece.x, piece.y);\n      context.rotate(piece.rotation);\n      context.fillStyle = piece.color;\n      context.fillRect(-piece.size / 2, -piece.size / 2, piece.size, piece.size * 0.66);\n      context.restore();\n    }\n  };\n\n  const tick = (timestamp: number): void => {\n    if (!start) start = timestamp;\n    draw();\n    if (timestamp - start <= durationMs) {\n      requestAnimationFrame(tick);\n      return;\n    }\n\n    context.clearRect(0, 0, width, height);\n    canvas.remove();\n  };\n\n  resize();\n  init();\n  window.addEventListener('resize', resize, { passive: true });\n  requestAnimationFrame(tick);\n}\n"],
  "mappings": "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",
  "names": ["payload"]
}
