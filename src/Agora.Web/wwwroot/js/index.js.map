{
  "version": 3,
  "sources": ["../../Scripts/index.ts"],
  "sourcesContent": ["(() => {\n  const nodes = document.querySelectorAll<HTMLElement>('[data-local-datetime]');\n  const formatter = new Intl.DateTimeFormat(undefined, { dateStyle: 'medium', timeStyle: 'short' });\n  nodes.forEach((node) => {\n    const value = node.getAttribute('data-local-datetime');\n    if (!value) return;\n    const date = new Date(value);\n    if (!Number.isNaN(date.getTime())) {\n      node.textContent = formatter.format(date);\n    }\n  });\n})();\n\n(() => {\n  const dialog = document.querySelector<HTMLDialogElement>('[data-share-delete-dialog]');\n  if (!dialog) return;\n\n  const nameNode = dialog.querySelector<HTMLElement>('[data-share-delete-name]');\n  const cancelButton = dialog.querySelector<HTMLButtonElement>('[data-share-delete-cancel]');\n  const confirmButton = dialog.querySelector<HTMLButtonElement>('[data-share-delete-confirm]');\n  let pendingForm: HTMLFormElement | null = null;\n\n  document.querySelectorAll<HTMLElement>('[data-share-delete-trigger]').forEach((button) => {\n    button.addEventListener('click', () => {\n      const form = button.closest<HTMLFormElement>('[data-share-delete-form]');\n      if (!form) return;\n      pendingForm = form;\n      if (nameNode) {\n        nameNode.textContent = form.getAttribute('data-share-name') ?? '';\n      }\n      dialog.showModal();\n    });\n  });\n\n  cancelButton?.addEventListener('click', () => dialog.close());\n  confirmButton?.addEventListener('click', () => {\n    pendingForm?.submit();\n    dialog.close();\n  });\n})();\n\ntype ShareFileLike = Record<string, unknown>;\n\n(() => {\n  const dialog = document.querySelector<HTMLDialogElement>('[data-share-details-dialog]');\n  if (!dialog) return;\n\n  const nameNode = dialog.querySelector<HTMLElement>('[data-share-details-name]');\n  const listNode = dialog.querySelector<HTMLElement>('[data-share-details-list]');\n  const closeButton = dialog.querySelector<HTMLButtonElement>('[data-share-details-close]');\n  if (!listNode) return;\n\n  const formatBytes = (bytes: number): string => {\n    const value = Number(bytes || 0);\n    if (!Number.isFinite(value) || value <= 0) return '0 B';\n    if (value >= 1024 * 1024 * 1024) return `${(value / (1024 * 1024 * 1024)).toFixed(1)} GB`;\n    if (value >= 1024 * 1024) return `${(value / (1024 * 1024)).toFixed(1)} MB`;\n    if (value >= 1024) return `${Math.round(value / 1024)} KB`;\n    return `${Math.round(value)} B`;\n  };\n\n  const getText = (item: ShareFileLike, key: string): string => {\n    const alt = key.charAt(0).toUpperCase() + key.slice(1);\n    const value = item[key] ?? item[alt];\n    return typeof value === 'string' ? value : '';\n  };\n\n  const getNumber = (item: ShareFileLike, key: string): number => {\n    const alt = key.charAt(0).toUpperCase() + key.slice(1);\n    const value = item[key] ?? item[alt] ?? 0;\n    const numeric = Number(value);\n    return Number.isFinite(numeric) ? numeric : 0;\n  };\n\n  document.querySelectorAll<HTMLElement>('[data-share-details-trigger]').forEach((button) => {\n    button.addEventListener('click', () => {\n      const shareName = button.getAttribute('data-share-name') ?? '';\n      const raw = button.getAttribute('data-share-files') ?? '[]';\n\n      let files: ShareFileLike[] = [];\n      try {\n        const parsed = JSON.parse(raw) as unknown;\n        files = Array.isArray(parsed) ? (parsed as ShareFileLike[]) : [];\n      } catch {\n        files = [];\n      }\n\n      files.sort((a, b) =>\n        getText(a, 'originalFilename').localeCompare(getText(b, 'originalFilename'), undefined, {\n          sensitivity: 'base'\n        })\n      );\n\n      listNode.innerHTML = '';\n      files.forEach((file) => {\n        const fileName = getText(file, 'originalFilename');\n        const fileSize = getNumber(file, 'originalSizeBytes');\n\n        const row = document.createElement('tr');\n        row.className = 'border-b border-border/60 last:border-b-0';\n\n        const nameCell = document.createElement('td');\n        nameCell.className = 'px-3 py-2 text-sm text-ink-light';\n        nameCell.textContent = fileName;\n\n        const sizeCell = document.createElement('td');\n        sizeCell.className = 'px-3 py-2 text-sm text-ink-muted text-right';\n        sizeCell.textContent = formatBytes(fileSize);\n\n        row.append(nameCell, sizeCell);\n        listNode.appendChild(row);\n      });\n\n      if (files.length === 0) {\n        const row = document.createElement('tr');\n        row.innerHTML = '<td colspan=\"2\" class=\"px-3 py-3 text-sm text-ink-muted\">No file metadata available.</td>';\n        listNode.appendChild(row);\n      }\n\n      if (nameNode) {\n        nameNode.textContent = shareName;\n      }\n      dialog.showModal();\n    });\n  });\n\n  closeButton?.addEventListener('click', () => dialog.close());\n})();\n\n(() => {\n  const dropzone = document.querySelector<HTMLElement>('[data-quick-share-dropzone]');\n  const fileInput = document.querySelector<HTMLInputElement>('[data-quick-share-input]');\n  const pickButton = document.querySelector<HTMLElement>('[data-quick-share-pick]');\n  const status = document.querySelector<HTMLElement>('[data-quick-share-status]');\n  const draftIdInput = document.querySelector<HTMLInputElement>('[data-quick-share-draft-id]');\n\n  if (!dropzone || !fileInput || !pickButton || !status || !draftIdInput?.value) return;\n\n  const draftShareId = draftIdInput.value;\n\n  const setStatus = (text: string, isError: boolean): void => {\n    status.textContent = text;\n    status.classList.remove('text-ink-muted', 'text-danger');\n    status.classList.add(isError ? 'text-danger' : 'text-ink-muted');\n  };\n\n  const uploadSingleFile = async (file: File): Promise<void> => {\n    const formData = new FormData();\n    formData.append('draftShareId', draftShareId);\n    formData.append('file', file, file.name);\n\n    const response = await fetch('/api/uploads/stage', { method: 'POST', body: formData });\n    if (!response.ok) {\n      let error = 'Upload failed.';\n      try {\n        const json = (await response.json()) as { error?: string };\n        if (json.error) {\n          error = json.error;\n        }\n      } catch {\n        // ignore non-json responses\n      }\n      throw new Error(error);\n    }\n  };\n\n  const queueAndUpload = async (files: FileList | File[] | null | undefined): Promise<void> => {\n    const list = Array.from(files ?? []);\n    if (list.length === 0) return;\n\n    setStatus(`Uploading ${list.length} file(s)...`, false);\n    try {\n      for (const file of list) {\n        await uploadSingleFile(file);\n      }\n      setStatus('Upload complete. Redirecting to share setup...', false);\n      window.location.href = `/shares/new?draftShareId=${encodeURIComponent(draftShareId)}`;\n    } catch (error) {\n      const message = error instanceof Error ? error.message : 'Upload failed.';\n      setStatus(message, true);\n    }\n  };\n\n  pickButton.addEventListener('click', (event) => {\n    event.stopPropagation();\n    fileInput.click();\n  });\n  dropzone.addEventListener('click', () => fileInput.click());\n  dropzone.addEventListener('keydown', (event) => {\n    if (event.key !== 'Enter' && event.key !== ' ') return;\n    event.preventDefault();\n    fileInput.click();\n  });\n\n  fileInput.addEventListener('change', () => {\n    queueAndUpload(fileInput.files);\n    fileInput.value = '';\n  });\n\n  dropzone.addEventListener('dragover', (event) => {\n    event.preventDefault();\n    dropzone.classList.add('ring-2', 'ring-terra/40');\n  });\n  dropzone.addEventListener('dragleave', () => dropzone.classList.remove('ring-2', 'ring-terra/40'));\n  dropzone.addEventListener('drop', (event) => {\n    event.preventDefault();\n    dropzone.classList.remove('ring-2', 'ring-terra/40');\n    queueAndUpload(event.dataTransfer?.files ?? []);\n  });\n})();\n"],
  "mappings": "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",
  "names": []
}
